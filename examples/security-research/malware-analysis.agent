# Malware Analysis Example
# Demonstrates security research mode for malware analysis in sandbox

SECURITY research "static and dynamic analysis of malware samples in isolated analysis sandbox"

NAME malware-analysis

INPUT sample_path
INPUT sandbox_env DEFAULT "isolated-vm"

GOAL static_analysis "Perform static analysis on the sample at $sample_path:
- Extract file metadata (hashes, timestamps, file type)
- Identify strings of interest (URLs, IPs, registry keys, file paths)
- Analyze PE headers and sections (if applicable)
- Check for known signatures and packers
- Extract embedded resources
Document all indicators of compromise (IOCs)."

GOAL behavioral_hypothesis "Based on static analysis, hypothesize behavioral characteristics:
- Likely persistence mechanisms
- Expected network communications
- Anticipated system modifications
- Potential evasion techniques
Create a behavioral analysis plan."

GOAL dynamic_indicators "Document expected dynamic indicators for sandbox analysis:
- Network IOCs to monitor (domains, IPs, ports)
- File system changes to track
- Registry modifications to watch
- Process behaviors to observe
NOTE: Actual dynamic execution requires isolated sandbox environment."

GOAL threat_classification "Classify the threat:
- Malware family identification (if known)
- Threat actor attribution (if possible)
- Campaign association
- Severity and risk assessment
- MITRE ATT&CK technique mapping"

GOAL detection_rules "Create detection rules and signatures:
- YARA rules for file detection
- Snort/Suricata rules for network detection
- Sigma rules for log-based detection
- IOC lists for threat intelligence platforms"

GOAL analysis_report "Generate a comprehensive malware analysis report:
- Executive summary
- Technical analysis details
- IOC appendix
- Detection guidance
- Remediation recommendations"

RUN analysis USING static_analysis, behavioral_hypothesis, dynamic_indicators, threat_classification, detection_rules, analysis_report
