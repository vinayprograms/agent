# 21 - Security Audit (with Profile)
# Comprehensive security review using reasoning-heavy model

NAME security-audit
INPUT target_path
INPUT scope DEFAULT "web application"

AGENT auditor FROM agents/security-auditor.md REQUIRES "reasoning-heavy"

GOAL recon "Use glob, ls, and read to understand the codebase structure at $target_path. Identify entry points and sensitive areas."
GOAL analyze "Analyze for $scope vulnerabilities: auth, injection, data exposure, misconfigurations." USING auditor
GOAL classify "Classify findings by severity (Critical/High/Medium/Low) with CVSS-like scoring."
GOAL report "Generate a security report with: executive summary, detailed findings, and remediation steps."

RUN audit USING recon, analyze, classify, report
