default_deny = false

# MCP Tool Security
# ---
# default_deny = false (or omitted): All MCP tools allowed (development mode)
# default_deny = true: Only tools in allowed_tools list can be called
[mcp]
default_deny = false  # Set to true for production
# allowed_tools = ["filesystem:read_file", "filesystem:list_directory", "memory:*"]

# Security Patterns and Keywords
# ---
# Extend the built-in security detection with custom patterns and keywords.
# Patterns are regex-based (for injection detection), keywords are simple word matches.
[security]
# Extra patterns: format is "name:regex"
# These are checked in addition to built-in patterns like ignore_previous, curl_pipe_bash, etc.
extra_patterns = [
    # "exfil_attempt:(?i)send.*to.*external",
    # "data_leak:(?i)upload.*credentials",
]
# Extra keywords: simple case-insensitive word matches
# These are checked in addition to built-in keywords like api_key, password, secret, etc.
extra_keywords = [
    # "internal_only",
    # "confidential",
    # "proprietary",
]

# Web Tool Security
# ---
# allow_domains restricts which domains can be fetched/searched
[web_fetch]
enabled = true
rate_limit = 30
# Recommended: restrict to known-good domains in production
# allow_domains = ["github.com", "*.github.io", "docs.python.org", "pkg.go.dev"]

[web_search]
enabled = true
rate_limit = 10

# File Tools
[read]
enabled = true

[write]
enabled = true

[edit]
enabled = true

[glob]
enabled = true

[grep]
enabled = true

[ls]
enabled = true

# Shell
[bash]
enabled = true
denylist = ["rm -rf *", "sudo *", "chmod 777 *"]

# Memory
[memory_read]
enabled = true

[memory_write]
enabled = true
