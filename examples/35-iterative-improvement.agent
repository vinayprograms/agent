# 35 - Iterative Improvement
# Example showing iterative improvement with multiple agents
# Each iteration: create -> critique -> improve until quality threshold met

NAME iterative-improvement

INPUT initial_content
INPUT quality_threshold DEFAULT "high"
INPUT output_file DEFAULT "improved-content.md"

AGENT creator """You are a skilled content creator. Create and refine content that is:
- Clear and well-structured
- Engaging and appropriate for the audience
- Free of errors"""

AGENT critic """You are a demanding critic. Evaluate content for:
- Clarity and conciseness
- Argument strength
- Engagement and flow
Provide specific, actionable feedback. If content meets $quality_threshold quality, say so clearly."""

AGENT improver """You are an expert editor. Implement improvements based on feedback.
Make targeted changes while preserving what works well."""

GOAL create "Create initial content based on: $initial_content" -> draft USING creator

CONVERGE refine """Review the current content critically for $quality_threshold quality.
If it meets the quality threshold, output CONVERGED.
Otherwise:
1. Identify specific weaknesses
2. Implement targeted improvements
3. Continue until quality threshold is met""" -> refined_content USING critic, improver WITHIN 5

GOAL finalize "Apply final polish and formatting to the refined content. Save to $output_file." USING improver

RUN init USING create
RUN improve USING refine
RUN finish USING finalize
