# 40 - Agentfile Builder
# Generates an Agentfile from a problem description
# Can analyze files/directories referenced in the problem

NAME agentfile-builder
INPUT problem_description
INPUT output_file DEFAULT "generated.agent"

AGENT syntax-expert FROM agents/agentfile-syntax.md

# Phase 1: Understand the problem
GOAL understand "Analyze the problem description: $problem_description

Identify:
1. What is the core task/goal?
2. What inputs are needed (required vs optional with defaults)?
3. Are there file paths or directories mentioned that need exploration?
4. What tools would be needed (bash, read, write, edit, glob)?
5. Should this be sequential (RUN) or iterative (LOOP)?
6. Would multiple specialized agents help?

If files or directories are referenced, use glob and read to understand their structure and content."

# Phase 2: Generate the Agentfile
GOAL generate "Generate a complete, valid Agentfile for the problem.

Follow the Agentfile syntax rules exactly. The workflow should:
- Have a clear, descriptive NAME
- Declare all necessary INPUTs with sensible DEFAULTs
- Break work into logical GOALs (one clear step each)
- Use RUN for sequential execution or LOOP for iterative
- Reference inputs with \$variable syntax
- Mention specific tools in goal descriptions
- Add helpful comments

Match complexity to the problem - simple problem = simple workflow." USING syntax-expert

# Phase 3: Write and display
GOAL output "Write the generated Agentfile to $output_file using the write tool.
Then display the full contents for review."

RUN build USING understand, generate, output
